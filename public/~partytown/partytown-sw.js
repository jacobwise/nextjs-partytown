const t=(t,e,r)=>new Response(t,{headers:{"content-type":1===e?"application/json":"text/html","Cache-Control":0===r?"max-age=31556952,immutable":"no-store"}}),e=new Map,r=t=>{const r=t.data,n=e.get(r.B);n&&(e.delete(r.B),clearTimeout(n[1]),n[0](r))},n=(t,e)=>({N:t.N,B:t.B,J:[],n:[e]});(s=>{s.oninstall=()=>s.skipWaiting(),s.onactivate=()=>s.clients.claim(),s.onmessage=r,s.onfetch=r=>((r,s)=>{const o=s.request,i=new URL(o.url).pathname;i.endsWith("partytown-sandbox")?s.respondWith(t('<!DOCTYPE html><html><head><meta charset="utf-8"><script type="module" async>(t=>{const e=t=>t.length,r=t=>t&&t.constructor&&t.constructor.name||"",n=(t,e)=>t.startsWith(e),s=t=>!(n(t,"webkit")||n(t,"toJSON")||n(t,"on")&&t.toLowerCase()===t),o=[],i=new Map,a=new WeakMap,c=[],u={},d=new Map,$=new WeakSet,h=(t,e,r)=>e?("number"!=typeof(r=(t=>{if(t){const e=t.nodeName;return"#document"===e?4:"HTML"===e?5:"HEAD"===e?6:"BODY"===e?7:a.get(t)}return-1})(e))&&p(t,e,r=Math.round(9999999999*Math.random()+7)),r):-1,l=(t,e,r,n,s)=>{if(n=d.get(t)){if(s=n.M.document,4===e)return s;if(5===e)return s.documentElement;if(6===e)return s.head;if(7===e)return s.body;if(r=c.find((t=>t[0]===e)))return r[1]}},p=(t,r,n)=>{if(r&&(c.push([n,r]),a.set(r,n),t.c++,t.c>99))for(t.c=0;;){let t,r,n=c.filter((t=>t[1].nodeType&&!t[1].isConnected));if(!(e(n)>99))break;for(t=0,r=e(c);t<r;t++)if(!c[t][1].isConnected){c.slice(t,1);break}}},f=(t,e,n,o,i,a)=>{if(void 0!==e){if(n=n||new Set,"string"==(o=typeof e)||"number"===o||"boolean"===o||null==e)return[4,e];if("function"===o)return[2];if(Array.isArray(e))return n.has(e)?[0,[]]:(n.add(e),[0,e.map((e=>f(t,e,n)))]);if("object"===o){if(e.nodeType)return[1,{N:t.N,v:e.nodeType,s:h(t,e),D:e.nodeName}];if(e===e.window)return[1,{N:t.N,v:0,s:0}];if(m(r(e)))return[1,{N:t.N,v:7,w$:Array.from(e).map((e=>f(t,e,n)[1]))}];if(i={},!n.has(e))for(a in n.add(e),e)s(a)&&(i[a]=f(t,e[a],n));return[3,i]}}},g=(t,e,r,n,s)=>{if(t){if(e=t[0],r=t[1],4===e)return r;if(5===e)return y(r);if(0===e)return r.map((t=>g(t)));if(1===e){const t=r;return l(t.N,t.s)}if(3===e){for(s in n={},r)n[s]=g(r[s]);return n}}},m=t=>"HTMLCollection"===t||"NodeList"===t,y=({N:t,s:e,G:r})=>{let n=u[e]=u[e]||{};return n[r]||(n[r]=function(...n){const s=d.get(t),o={N:t,s:e,G:r,K:f(s,this),b:f(s,n)};s.O.postMessage([4,o])}),n[r]},w=t=>{const r=t.N,n=t.M,s=n.document,o=s.querySelector(\'script[type="text/partytown"]:not([data-pt-id]):not([data-pt-error])\');if(o){const e=h(t,o,r),n={N:r,s:e};o.dataset.ptId=r+"."+e,o.src?n.L=o.src:n.e=o.innerHTML,t.O.postMessage([3,n])}else t.x||(t.x=!0,n.frameElement&&(n.frameElement.partyWinId=r),((t,r)=>{let n=r._ptf,s=0;if(n){for(r._ptf.push=(e,r)=>t.O.postMessage([7,{N:t.N,s:0,d:e,b:f(t,Array.from(r))}]);s<e(n);s+=2)r._ptf.push(n[s],n[s+1]);n.length=0}})(t,n),s.dispatchEvent(new CustomEvent("ptinit")))},I=(t,e)=>{let n,o,i,a;for(n in t)s(n)&&(i=t[n],a=typeof i,"function"===a?e[n]=2:"object"===a&&(o=S[r(i)],o&&(e[n]=o)));return e},S={CSSStyleDeclaration:11,DOMStringMap:5,DOMTokenList:6,NamedNodeMap:4,NodeList:7},k=(t,e)=>e[0]in t;(async(t,r)=>{const n=t.parent,s=t.navigator.serviceWorker,a=await s.getRegistration(),c=t=>{const r=t.data,n=r.N,s=d.get(n);s&&(async(t,r)=>{const n={B:r.B,N:r.N,n:[]};for(const i of r.J){let a,c,u,d,$,h,m,y=i.s,w=i.a,I=i.A,S=e(I),E=I[S-1],b=i.q||o;try{if(u=g(i.h),r.p)continue;if(a=l(n.N,y),a){for(d=0;d<S-1;d++)a=a[I[d]];0===w?("partyWinId"===E&&await new Promise((t=>{$=0,h=setInterval((()=>{(k(a,I)||$>99)&&(clearInterval(h),t()),$++}),40)})),c=a[E]):1===w?a[E]=u:2===w&&(c=a[E].apply(a,u),b.map((t=>{m=t[0][0],c[m]=g(t[1])})),i.C&&p(t,c,i.C)),"object"==typeof(s=c)&&s&&s.then&&(c=await c,n.y=!0),n.H=f(t,c)}else n.n.push(`Instance ${y} not found`)}catch(t){n.n.push(String(t.stack||t))}}var s;return r.p?((t,e)=>new Promise((r=>{i.set(e.B,r),t.postMessage([5,e])})))(t.O,r):n})(s,r).then((t=>{a&&a.active&&a.active.postMessage(t)}))},u=t=>{if(!$.has(t)){$.add(t);const e=t.parent,o={N:t.partyWinId=r++,E:e.partyWinId,d:n.partytown,c:0,I:a.scope,L:t.document.baseURI,M:t};d.set(o.N,o),p(o,t,0),p(o,t.history,1),p(o,t.localStorage,2),p(o,t.sessionStorage,3),s.addEventListener("message",c),(t=>{t.O=new Worker(URL.createObjectURL(new Blob([\'(t=>{const e={},r=Symbol(),n=Symbol(),s=Symbol(),o=Symbol(),i=Symbol(),a=Symbol(),c={},$=new WeakMap,h={},u={},d=t=>t.toUpperCase(),l=t=>t.length,p=(t,e)=>setTimeout(t,e),g=[],m="text/partytown",f=\\\'<script src="/~partytown/partytown.js" async defer><\\\\/script>\\\',y=()=>Math.round(9999999999*Math.random()+7),I=(t,e)=>w(t[n],e),w=(t,e,r)=>(r=h[t])?r[e]:void 0,S=(t,e,r)=>E(t[n],e,r),E=(t,e,r,n)=>{(n=h[t]||{})[e]=r,h[t]=n},b=(t,e,r)=>((r=w(t,e))&&p((()=>r.map((t=>t({type:"error"===e?"error":"load"}))))),!!r),T=(t,e)=>{u.f=t,u.g=e},R=t=>new URL(t||"",u.z+""),k=t=>R(I(t,"href")),x=(t,e)=>{try{return fetch(t,{method:"POST",mode:"no-cors",keepalive:!0}),!0}catch(t){return console.error(t),!1}};class M{constructor(t,e,i,c){return this[r]=i||u.N,this[n]=e,this[o]=c,this[a]=void 0,X(this[s]=t,this,[])}}class v extends M{appendChild(t){return this.insertBefore(t,null)}get ownerDocument(){return document}get href(){}set href(t){}insertBefore(t,e){return z(this[r],t),"IFRAME"===(t=Y(this,["insertBefore"],[t,e],g))[o]?(t=>{let e=I(t,1)?"load":"error",r=I(t,e);r&&r.forEach((t=>t({type:"load"})))})(t):"SCRIPT"===t[o]&&u.F([3]),t}get nodeName(){return this[o]}get nodeType(){return this[s]}}class N{constructor(t){(this._=t).forEach(((t,e)=>this[e]=t))}entries(){return this._.entries()}forEach(t,e){this._.forEach(t,e)}item(t){return this[t]}keys(){return this._.keys()}get length(){return l(this._)}values(){return this._.values()}[Symbol.iterator](){return this._[Symbol.iterator]()}}class P extends v{get localName(){return this.nodeName.toLowerCase()}get tagName(){return this.nodeName}}class j extends P{addEventListener(...t){let e=t[0],r=I(this,e)||[];r.push(t[1]),S(this,e,r)}get async(){return!0}set async(t){}get defer(){return!0}set defer(t){}get onload(){let t=I(this,"load");return t&&t[0]||null}set onload(t){S(this,"load",t?[t]:null)}get onerror(){let t=I(this,"error");return t&&t[0]||null}set onerror(t){S(this,"error",t?[t]:null)}}class A extends P{get hash(){return k(this).hash}get host(){return k(this).host}get hostname(){return k(this).hostname}get href(){return k(this)+""}set href(t){S(this,"href",t),V(this,["href"],t)}get origin(){return k(this).origin}get pathname(){return k(this).pathname}get port(){return k(this).port}get protocol(){return k(this).protocol}get search(){return k(this).search}}class C extends URL{assign(){}reload(){}replace(){}}class O extends j{get contentDocument(){return this.contentWindow.document}get contentWindow(){let t,e=I(this,2);return e||(e=q(this,["partyWinId"]),S(this,2,e)),t=new B(0,0,e),t.location=this.src,t}get src(){return I(this,3)||""}set src(t){let e,s,o=new XMLHttpRequest;t=R(t)+"",this.src!==t&&(S(this,3,t),o.open("GET",t,!1),o.send(),s=o.status>199&&o.status<300,S(this,1,s),s&&(e=((t,e)=>`<base href="${t}">`+e.replace(/<script>/g,\\\'<script type="text/partytown">\\\').replace(/<script /g,\\\'<script type="text/partytown" \\\').replace(/text\\\\/javascript/g,m)+f)(t,o.responseText),this[a]?this[a].push([["srcdoc"],G(this[r],this[n],e)]):V(this,["srcdoc"],e)))}}class B extends M{get document(){return F(9,4,this[r])}get location(){let t=I(this,3);return t||S(this,3,t=new C("about:blank")),t}set location(t){this.location.href=t&&""!==t?t:"about:blank"}get parent(){return F(0,0,u.E)}get self(){return this}get top(){return top}get window(){return this}}class D extends P{get body(){return F(1,7,this[r],"BODY")}get compatMode(){return u.i}get cookie(){return u.j,u.j}set cookie(t){V(this,["cookie"],u.j=t)}createElement(t){t=d(t);const e=this[r],n=y(),s=new(H(t))(1,n,e,t);return s[a]="SCRIPT"===t?[[["type"],G(e,n,m)]]:"IFRAME"===t?[[["srcdoc"],G(e,n,f)]]:[],s}get createEventObject(){}get currentScript(){return u.f?F(1,u.f,this[r],"SCRIPT"):null}get defaultView(){return t}get documentElement(){return F(1,5,this[r],"HTML")}getElementsByTagName(t){return"BODY"===(t=d(t))?[this.body]:"HEAD"===t?[this.head]:"SCRIPT"===t?[F(1,u.o,this[r],"SCRIPT")]:Y(this,["getElementsByTagName"],[t])}get head(){return F(1,6,this[r],"HEAD")}get implementation(){return{hasFeature:()=>!0}}get location(){return u.z,u.z}set location(t){u.z.href=t+""}get parentNode(){return null}get parentElement(){return null}get readyState(){return"complete"!==u.k?u.k=q(this,["readyState"]):u.k,u.k}get referrer(){return u.l,u.l}get title(){return u.m,u.m}set title(t){V(this,["title"],u.m=t)}}class L extends P{get parentElement(){return document.documentElement}get parentNode(){return document.documentElement}}class W extends j{get src(){return this[r]===u.N?I(this,3)||"":q(this,["src"])}set src(t){this[r]===u.N?(t=R(t)+"",S(this,3,t),this[a]&&this[a].push([["src"],G(this[r],this[n],t)])):V(this,["src"],t)}get type(){return q(this,["type"])}set type(t){"text/javascript"!==t&&V(this,["type"],t)}}const F=(t,e,r,n)=>new(_(t,n=9===t?"#document":3===t?"#text":n))(t,e,r,n),_=(t,e)=>1===t?H(e):9===t?D:0===t?B:3===t?v:M,H=t=>({A,BODY:L,HEAD:L,IFRAME:O,SCRIPT:W}[t]||P),J=(t,i,a,c,$,h)=>{const d=t[r],l=e[d]=e[d]||[],p=u.N!==d,g={s:t[n],v:t[s],D:t[o],a:i,A:a,h:c,q:$,C:h};return l.push(g),U(d,g.s,a,p,l)},U=(t,e,r,n,s)=>{if(l(s)){const o=new XMLHttpRequest,i={B:y(),N:t,p:n,J:[...s]};JSON.stringify(i),s.length=0,o.open("POST",u.I+"proxytown",!1),o.send(JSON.stringify(i));const a=JSON.parse(o.responseText),c=a.n.join(),$=a.y,h=K(t,e,r,a.H);if(c){if($)return Promise.reject(c);throw new Error(c)}return $?Promise.resolve(h):h}},q=(t,e)=>{z(t[r],t);return J(t,0,e)},V=(t,e,s)=>{if(t[a])t[a].push([e,G(t[r],t[n],s)]);else{const o=G(t[r],t[n],s);"function"==typeof s&&S(t,e.join("."),s),J(t,1,e,o)}},Y=(t,e,s,o,i)=>{z(t[r],t);return J(t,2,e,G(t[r],t[n],s),o,i)},z=(t,e)=>{const r=e[a];if(r){e[a]=void 0;const s=F(9,4,t,"#document");Y(s,["createElement"],[e[o]],r,e[n])}},X=(t,e,r)=>!e||"object"!=typeof e&&"function"!=typeof e||e[i]||String(e).includes("[native")?e:new Proxy(e,{get(e,n){if(n===i)return!0;if(Reflect.has(e,n))return Reflect.get(e,n);const s=[...r,String(n)];return((t,e,r)=>{const n=u.u.find((e=>e[0]===t));if(n){const t=n[1][r[l(r)-1]];if(2===t)return(...t)=>Y(e,r,t);if(t>0)return X(t,e,[...r])}const s=I(e,r.join("."));if("function"==typeof s)return(...t)=>s.apply(e,t)})(t,e,s)||q(e,s)},set:(t,e,n,s)=>(Reflect.has(t,e)?Reflect.set(t,e,n,s):V(t,[...r,String(e)],n),!0)}),G=(t,e,i,a)=>{if(void 0!==i){a=a||new Set;let d,l,p=typeof i;if("string"===p||"boolean"===p||"number"===p||null==i)return[4,i];if("function"===p)return[5,{N:t,s:e,G:(h=i,(u=$.get(h))||($.set(h,u=y()),c[u]=h),u)}];if(Array.isArray(i))return a.has(i)?[0,[]]:[0,i.map((r=>G(t,e,r,a)))];if("object"===p){if("number"==typeof i[n])return[1,{N:i[r],v:i[s],s:i[n],D:i[o]}];if(l={},!a.has(i))for(d in a.add(i),i)l[d]=G(t,e,i[d],a);return[3,l]}}var h,u},K=(t,e,r,n,s,o,i,a)=>{if(n){if(s=n[0],o=n[1],4===s)return o;if(5===s)return Z(e,r,o);if(1===s)return Q(o);if(0===s)return o.map((n=>K(t,e,r,n)));if(3===s){for(a in i={},o)i[a]=K(t,e,[...r,a],o[a]);return i}}},Q=({v:e,s:r,N:n,D:s,w$:o})=>1===r?history:2===r?localStorage:3===r?sessionStorage:0===r?t:7===e?new N(o.map(Q)):F(e,r,n,s),Z=(t,e,{N:r,G:n})=>{let s,o=w(t,0);return o||E(t,0,o={}),s=o[n],s||(o[n]=s=function(...n){const s=F(0,t,r);return Y(s,e,n)}),s};class tt{constructor(){this.s="",this.l=[],this.e=[]}get src(){return this.s}set src(t){fetch(R(t)+"",{mode:"no-cors",keepalive:!0}).then((t=>{t.ok?this.l.forEach((t=>t({type:"load"}))):this.e.forEach((t=>t({type:"error"})))}),(()=>this.e.forEach((t=>t({type:"error"})))))}addEventListener(t,e){"load"===t&&this.l.push(e),"error"===t&&this.e.push(e)}get onload(){return this.l[0]}set onload(t){this.l=[t]}get onerror(){return this.e[0]}set onerror(t){this.e=[t]}}const et=[],rt=e=>{const s=e.data,o=s[0],i=s[1],a=s[2];u.x?3===o?(t=>{t.N;let e=t.s,r=t.e,n=t.L,s="",o="load";if(n){try{n=R(n)+"",E(e,3,n),T(e,n),u.r(n)}catch(t){console.error(name,t,"\\\\n"+n),o="error",s=String(t.stack||t)+""}b(e,o)||u.F([8,e,o])}else if(r)try{T(e,""),new Function(r)()}catch(t){console.error(name,t,"\\\\n"+r),o="error",s=String(t.stack||t)+""}T(-1,""),u.F([2,e,s])})(i):4===o?(({N:t,s:e,G:r,K:n,b:s},o)=>{if(o=c[r])try{const r=K(t,e,[],n),i=K(t,e,[],s);o.apply(r,i)}catch(t){console.error(t)}})(i):5===o?(t=>{const e=t.N,r={B:t.B,N:e,n:[]};for(const n of t.J){let t,s,o,i,a=n.s,c=n.a,$=n.A,h=l($),u=$[h-1];try{for(t=Q({...n,N:e}),i=0;i<h-1;i++)t=t[$[i]];o=K(e,a,$,n.h),0===c?s=t[u]:1===c?t[u]=o:2===c&&(s=4===a&&"createElement"===u?Y(t,$,o,n.q,n.C):t[u].apply(t,o)),r.H=G(e,a,s)}catch(t){r.n.push(String(t.stack||t))}}u.F([6,r])})(i):7===o?(({N:e,s:r,b:n,d:s})=>{let o,i=K(e,r,[],n),a=t;s.split(".").forEach(((t,e,r)=>{a&&(o=a[t],e===r.length-1&&"function"==typeof o?o.apply(a,i):a=a[t])}))})(i):8===o&&b(i,a):1===o?(((t,e)=>{Object.assign(u,e),u.N,u.N>1&&u.E,u.r=importScripts.bind(t),t.importScripts=void 0,u.F=postMessage.bind(t),t.postMessage=(t,e)=>{JSON.stringify(t)},u.z=new C(e.L),((t,e)=>{t[r]=u.N,t[n]=0,Object.keys(e).forEach((r=>{t[r]||2!==e[r]||(t[r]=(...e)=>Y(t,[r],e))})),t.requestAnimationFrame=t=>p((()=>t(Date.now())),9),t.cancelAnimationFrame=clearTimeout,Object.defineProperty(t,"location",{get:()=>u.z,set:t=>u.z.href=t+""}),t.document=F(9,4),t.history=F(8,1),t.localStorage=F(10,2),t.sessionStorage=F(10,3),t.Image=tt,navigator.sendBeacon=x,t.self=t.window=t,1===u.N?t.parent=t.top=t:(t.parent=F(0,0,u.E),t.top=F(0,0,1))})(t,e.u[0][1]),u.x=!0})(t,i),u.F([3]),p((()=>{et.slice().forEach(rt),et.length=0}))):et.push(e)};t.onmessage=rt,postMessage([0])})(self);\\n\'],{type:"text/javascript"})),{name:`Partytown (${t.N}) 🎉`}),t.O.onmessage=e=>((t,e)=>{const r=e[0],n=t.M.document;if(0===r){const e=h(t,n.querySelector("script")),r=((t,e)=>{const r=e.implementation.createHTMLDocument(),n=r.documentElement;return[[0,t],[9,r],[6,n.classList],[1,n],[8,t.history],[7,n.childNodes],[10,t.sessionStorage],[3,r.createTextNode("")]].map((([t,e])=>[t,I(e,{})]))})(t.M,n),s={N:t.N,E:t.E,d:t.d||{},i:n.compatMode,j:n.cookie,k:n.readyState,l:n.referrer,m:n.title,o:e,u:r,I:t.I,L:t.L};t.O.postMessage([1,s])}else if(3===r)w(t);else if(2===r)((t,e,r,n,s)=>{(s=e.querySelector(\'[data-pt-id="\'+t.N+"."+r+\'"]\'))&&(n?s.dataset.ptError=n:s.type+="-init"),w(t)})(t,n,e[1],e[2]);else if(6===r){const r=e[1],n=i.get(r.B);n&&(i.delete(r.B),n(r),w(t))}else 8===r&&d.forEach((t=>t.O.postMessage(e)))})(t,e.data)})(o),t.addEventListener("load",(()=>w(o)))}};n.partyWin=u,a&&u(n)})(t,1)})(window);\n<\/script></head></html>',0,1)):i.endsWith("proxytown")&&s.respondWith(((r,s)=>new Promise((async o=>{const i=await s.clone().json(),a=await((t,r)=>new Promise((async s=>{const o=[...await t.clients.matchAll()].sort(((t,e)=>t.url>e.url?-1:t.url<e.url?1:0))[0];if(o){const t=[s,setTimeout((()=>{e.delete(r.B),s(n(r,"Timeout"))}),1e4)];e.set(r.B,t),o.postMessage(r)}else s(n(r,"No Party"))})))(r,i);o(t(JSON.stringify(a),1,1))})))(r,o))})(s,r)})(self);
