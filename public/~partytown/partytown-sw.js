const t=new Map,e=(t,e)=>({O:t.O,D:t.D,K:[],n:[e]}),r=(t,e)=>new Response(t,{headers:{"content-type":e||"text/html","Cache-Control":"no-store"}}),n=self;n.oninstall=()=>n.skipWaiting(),n.onactivate=()=>n.clients.claim(),n.onmessage=e=>{const r=e.data,n=t.get(r.D);n&&(t.delete(r.D),clearTimeout(n[1]),n[0](r))},n.onfetch=s=>((n,s)=>{const o=s.request,i=new URL(o.url).pathname;i.endsWith("partytown-sandbox-sw.html")?s.respondWith(r('<!DOCTYPE html><html><head><meta charset="utf-8"><script type="module">(t=>{const e=t=>t.length,r=t=>t&&t.constructor&&t.constructor.name||"",n=(t,e)=>t.startsWith(e),s=t=>!(n(t,"webkit")||n(t,"toJSON")||n(t,"on")&&t.toLowerCase()===t),o=[],i=new Map,a=new WeakMap,c=[],u={},$=new Map,d=new WeakSet,l=(t,e,r)=>e?("number"!=typeof(r=(t=>{if(t){const e=t.nodeName;return"#document"===e?4:"HTML"===e?5:"HEAD"===e?6:"BODY"===e?7:a.get(t)}return-1})(e))&&p(t,e,r=Math.round(9999999999*Math.random()+7)),r):-1,h=(t,e,r,n,s)=>{if(n=$.get(t)){if(s=n.N.document,4===e)return s;if(5===e)return s.documentElement;if(6===e)return s.head;if(7===e)return s.body;if(r=c.find((t=>t[0]===e)))return r[1]}},p=(t,r,n)=>{if(r&&(c.push([n,r]),a.set(r,n),t.c++,t.c>99))for(t.c=0;;){let t,r,n=c.filter((t=>t[1].nodeType&&!t[1].isConnected));if(!(e(n)>99))break;for(t=0,r=e(c);t<r;t++)if(!c[t][1].isConnected){c.slice(t,1);break}}},f=(t,e,n,o,i,a)=>{if(void 0!==e){if(n=n||new Set,"string"==(o=typeof e)||"number"===o||"boolean"===o||null==e)return[4,e];if("function"===o)return[2];if(Array.isArray(e))return n.has(e)?[0,[]]:(n.add(e),[0,e.map((e=>f(t,e,n)))]);if("object"===o){if(e.nodeType)return[1,{O:t.O,w:e.nodeType,t:l(t,e),F:e.nodeName}];if(e===e.window)return[1,{O:t.O,w:0,t:0}];if(g(r(e)))return[1,{O:t.O,w:7,x$:Array.from(e).map((e=>f(t,e,n)[1]))}];if(i={},!n.has(e))for(a in n.add(e),e)s(a)&&(i[a]=f(t,e[a],n));return[3,i]}}},m=(t,e,r,n,s)=>{if(t){if(e=t[0],r=t[1],4===e)return r;if(5===e)return y(r);if(0===e)return r.map((t=>m(t)));if(1===e){const t=r;return h(t.O,t.t)}if(3===e){for(s in n={},r)n[s]=m(r[s]);return n}}},g=t=>"HTMLCollection"===t||"NodeList"===t,y=({O:t,t:e,I:r})=>{let n=u[e]=u[e]||{};return n[r]||(n[r]=function(...n){const s=$.get(t),o={O:t,t:e,I:r,L:f(s,this),b:f(s,n)};s.P.postMessage([4,o])}),n[r]},w=t=>{const r=t.O,n=t.N,s=n.document,o=s.querySelector(\'script[type="text/partytown"]:not([data-pt-id]):not([data-pt-error])\');if(o){const e=l(t,o,r),n={O:r,t:e};o.dataset.ptId=r+"."+e,o.src?n.M=o.src:n.e=o.innerHTML,t.P.postMessage([3,n])}else t.y||(t.y=!0,n.frameElement&&(n.frameElement._ptId=r),((t,r)=>{let n=r._ptf,s=r._ptf=[],o=0;if(s.push=(e,r)=>t.P.postMessage([7,{O:t.O,t:0,p:e,b:f(t,Array.from(r))}]),n)for(;o<e(n);o+=2)s.push(n[o],n[o+1])})(t,n),s.dispatchEvent(new CustomEvent("ptinit")))},I=(t,e)=>{let n,o,i,a;for(n in t)s(n)&&(i=t[n],a=typeof i,"function"===a?e[n]=2:"object"===a&&(o=S[r(i)],o&&(e[n]=o)));return e},S={CSSStyleDeclaration:11,DOMStringMap:5,DOMTokenList:6,NamedNodeMap:4,NodeList:7},b=(t,e)=>e[0]in t;(async(t,r)=>{const n=t.parent,s=n.partytown||{},a=s.lib||"/~partytown/",c=t=>{if(!d.has(t)){d.add(t);const e=t.parent,n={O:t._ptId=r++,G:e._ptId,c:0,d:s,A:a,M:t.document.baseURI,N:t};$.set(n.O,n),p(n,t,0),p(n,t.history,1),p(n,t.localStorage,2),p(n,t.sessionStorage,3),(t=>{t.P=new Worker(URL.createObjectURL(new Blob([\'(t=>{const e={},r=Symbol(),n=Symbol(),s=Symbol(),o=Symbol(),i=Symbol(),a=Symbol(),c={},$=new WeakMap,h={},u={},d=t=>t.toUpperCase(),l=t=>t.length,p=(t,e)=>setTimeout(t,e),g=[],m=()=>Math.round(9999999999*Math.random()+7),f="text/partytown",y=(t,e)=>I(t[n],e),I=(t,e,r)=>(r=h[t])?r[e]:void 0,w=(t,e,r)=>S(t[n],e,r),S=(t,e,r,n)=>{(n=h[t]||{})[e]=r,h[t]=n},b=(t,e,r)=>((r=I(t,e))&&p((()=>r.map((t=>t({type:"error"===e?"error":"load"}))))),!!r),E=(t,e)=>{u.f=t,u.g=e},T=t=>new URL(t||"",u.B+""),R=t=>T(y(t,"href")),k=()=>`<script src=${JSON.stringify(u.A+"partytown.js")} async defer><\\\\/script>`,x=(t,e)=>{try{return fetch(t,{method:"POST",mode:"no-cors",keepalive:!0}),!0}catch(t){return console.error(t),!1}};class M{constructor(t,e,i,c){return this[r]=i||u.O,this[n]=e,this[o]=c,this[a]=void 0,X(this[s]=t,this,[])}}class v extends M{appendChild(t){return this.insertBefore(t,null)}get ownerDocument(){return document}get href(){}set href(t){}insertBefore(t,e){return z(this[r],t),"IFRAME"===(t=Y(this,["insertBefore"],[t,e],g))[o]?(t=>{let e=y(t,1)?"load":"error",r=y(t,e);r&&r.forEach((t=>t({type:"load"})))})(t):"SCRIPT"===t[o]&&u.H([3]),t}get nodeName(){return this[o]}get nodeType(){return this[s]}}class P{constructor(t){(this._=t).forEach(((t,e)=>this[e]=t))}entries(){return this._.entries()}forEach(t,e){this._.forEach(t,e)}item(t){return this[t]}keys(){return this._.keys()}get length(){return l(this._)}values(){return this._.values()}[Symbol.iterator](){return this._[Symbol.iterator]()}}class N extends v{get localName(){return this.nodeName.toLowerCase()}get tagName(){return this.nodeName}}class A extends N{addEventListener(...t){let e=t[0],r=y(this,e)||[];r.push(t[1]),w(this,e,r)}get async(){return!0}set async(t){}get defer(){return!0}set defer(t){}get onload(){let t=y(this,"load");return t&&t[0]||null}set onload(t){w(this,"load",t?[t]:null)}get onerror(){let t=y(this,"error");return t&&t[0]||null}set onerror(t){w(this,"error",t?[t]:null)}}class j extends N{get hash(){return R(this).hash}get host(){return R(this).host}get hostname(){return R(this).hostname}get href(){return R(this)+""}set href(t){w(this,"href",t),V(this,["href"],t)}get origin(){return R(this).origin}get pathname(){return R(this).pathname}get port(){return R(this).port}get protocol(){return R(this).protocol}get search(){return R(this).search}}class C extends URL{assign(){}reload(){}replace(){}}class O extends A{get contentDocument(){return this.contentWindow.document}get contentWindow(){let t,e=y(this,2);return e||(e=q(this,["_ptId"]),w(this,2,e)),t=new B(0,0,e),t.location=this.src,t}get src(){return y(this,3)||""}set src(t){let e,s,o=new XMLHttpRequest;t=T(t)+"",this.src!==t&&(w(this,3,t),o.open("GET",t,!1),o.send(),s=o.status>199&&o.status<300,w(this,1,s),s&&(e=((t,e)=>`<base href="${t}">`+e.replace(/<script>/g,\\\'<script type="text/partytown">\\\').replace(/<script /g,\\\'<script type="text/partytown" \\\').replace(/text\\\\/javascript/g,f)+k())(t,o.responseText),this[a]?this[a].push([["srcdoc"],G(this[r],this[n],e)]):V(this,["srcdoc"],e)))}}class B extends M{get document(){return F(9,4,this[r])}get location(){let t=y(this,3);return t||w(this,3,t=new C("about:blank")),t}set location(t){this.location.href=t&&""!==t?t:"about:blank"}get parent(){return F(0,0,u.G)}get self(){return this}get top(){return top}get window(){return this}}class D extends N{get body(){return F(1,7,this[r],"BODY")}get compatMode(){return u.i}get cookie(){return u.j,u.j}set cookie(t){V(this,["cookie"],u.j=t)}createElement(t){t=d(t);const e=this[r],n=m(),s=new(H(t))(1,n,e,t);return s[a]="SCRIPT"===t?[[["type"],G(e,n,f)]]:"IFRAME"===t?[[["srcdoc"],G(e,n,k())]]:[],s}get createEventObject(){}get currentScript(){return u.f?F(1,u.f,this[r],"SCRIPT"):null}get defaultView(){return t}get documentElement(){return F(1,5,this[r],"HTML")}getElementsByTagName(t){return"BODY"===(t=d(t))?[this.body]:"HEAD"===t?[this.head]:"SCRIPT"===t?[F(1,u.o,this[r],"SCRIPT")]:Y(this,["getElementsByTagName"],[t])}get head(){return F(1,6,this[r],"HEAD")}get implementation(){return{hasFeature:()=>!0}}get location(){return u.B,u.B}set location(t){u.B.href=t+""}get parentNode(){return null}get parentElement(){return null}get readyState(){return"complete"!==u.k?u.k=q(this,["readyState"]):u.k,u.k}get referrer(){return u.l,u.l}get title(){return u.m,u.m}set title(t){V(this,["title"],u.m=t)}}class L extends N{get parentElement(){return document.documentElement}get parentNode(){return document.documentElement}}class _ extends A{get src(){return this[r]===u.O?y(this,3)||"":q(this,["src"])}set src(t){this[r]===u.O?(t=T(t)+"",w(this,3,t),this[a]&&this[a].push([["src"],G(this[r],this[n],t)])):V(this,["src"],t)}get type(){return q(this,["type"])}set type(t){"text/javascript"!==t&&V(this,["type"],t)}}const F=(t,e,r,n)=>new(W(t,n=9===t?"#document":3===t?"#text":n))(t,e,r,n),W=(t,e)=>1===t?H(e):9===t?D:0===t?B:3===t?v:M,H=t=>({A:j,BODY:L,HEAD:L,IFRAME:O,SCRIPT:_}[t]||N),J=(t,i,a,c,$,h)=>{const d=t[r],l=e[d]=e[d]||[],p=u.O!==d,g={t:t[n],w:t[s],F:t[o],a:i,C:a,h:c,r:$,E:h};return l.push(g),U(d,g.t,a,p,l)},U=(t,e,r,n,s)=>{if(l(s)){const o={D:m(),O:t,q:n,K:[...s]},i=((t,e)=>{const r=new XMLHttpRequest,n=t.A+"proxytown";return r.open("POST",n,!1),r.send(JSON.stringify(e)),JSON.parse(r.responseText)})(u,o),a=i.n.join(),c=i.z,$=K(t,e,r,i.J);if(s.length=0,a){if(c)return Promise.reject(a);throw new Error(a)}return c?Promise.resolve($):$}},q=(t,e)=>{z(t[r],t);return J(t,0,e)},V=(t,e,s)=>{if(t[a])t[a].push([e,G(t[r],t[n],s)]);else{const o=G(t[r],t[n],s);"function"==typeof s&&w(t,e.join("."),s),J(t,1,e,o)}},Y=(t,e,s,o,i)=>{z(t[r],t);return J(t,2,e,G(t[r],t[n],s),o,i)},z=(t,e)=>{const r=e[a];if(r){e[a]=void 0;const s=F(9,4,t,"#document");Y(s,["createElement"],[e[o]],r,e[n])}},X=(t,e,r)=>!e||"object"!=typeof e&&"function"!=typeof e||e[i]||String(e).includes("[native")?e:new Proxy(e,{get(e,n){if(n===i)return!0;if(Reflect.has(e,n))return Reflect.get(e,n);const s=[...r,String(n)];return((t,e,r)=>{const n=u.v.find((e=>e[0]===t));if(n){const t=n[1][r[l(r)-1]];if(2===t)return(...t)=>Y(e,r,t);if(t>0)return X(t,e,[...r])}const s=y(e,r.join("."));if("function"==typeof s)return(...t)=>s.apply(e,t)})(t,e,s)||q(e,s)},set:(t,e,n,s)=>(Reflect.has(t,e)?Reflect.set(t,e,n,s):V(t,[...r,String(e)],n),!0)}),G=(t,e,i,a)=>{if(void 0!==i){a=a||new Set;let d,l,p=typeof i;if("string"===p||"boolean"===p||"number"===p||null==i)return[4,i];if("function"===p)return[5,{O:t,t:e,I:(h=i,(u=$.get(h))||($.set(h,u=m()),c[u]=h),u)}];if(Array.isArray(i))return a.has(i)?[0,[]]:[0,i.map((r=>G(t,e,r,a)))];if("object"===p){if("number"==typeof i[n])return[1,{O:i[r],w:i[s],t:i[n],F:i[o]}];if(l={},!a.has(i))for(d in a.add(i),i)l[d]=G(t,e,i[d],a);return[3,l]}}var h,u},K=(t,e,r,n,s,o,i,a)=>{if(n){if(s=n[0],o=n[1],4===s)return o;if(5===s)return Z(e,r,o);if(1===s)return Q(o);if(0===s)return o.map((n=>K(t,e,r,n)));if(3===s){for(a in i={},o)i[a]=K(t,e,[...r,a],o[a]);return i}}},Q=({w:e,t:r,O:n,F:s,x$:o})=>1===r?history:2===r?localStorage:3===r?sessionStorage:0===r?t:7===e?new P(o.map(Q)):F(e,r,n,s),Z=(t,e,{O:r,I:n})=>{let s,o=I(t,0);return o||S(t,0,o={}),s=o[n],s||(o[n]=s=function(...n){const s=F(0,t,r);return Y(s,e,n)}),s};class tt{constructor(){this.s="",this.l=[],this.e=[]}get src(){return this.s}set src(t){fetch(T(t)+"",{mode:"no-cors",keepalive:!0}).then((t=>{t.ok?this.l.forEach((t=>t({type:"load"}))):this.e.forEach((t=>t({type:"error"})))}),(()=>this.e.forEach((t=>t({type:"error"})))))}addEventListener(t,e){"load"===t&&this.l.push(e),"error"===t&&this.e.push(e)}get onload(){return this.l[0]}set onload(t){this.l=[t]}get onerror(){return this.e[0]}set onerror(t){this.e=[t]}}const et=[],rt=e=>{const s=e.data,o=s[0],i=s[1],a=s[2];u.y?3===o?(t=>{t.O;let e=t.t,r=t.e,n=t.M,s="",o="load";if(n){try{n=T(n)+"",S(e,3,n),E(e,n),u.s(n)}catch(t){console.error(name,t,"\\\\n"+n),o="error",s=String(t.stack||t)+""}b(e,o)||u.H([8,e,o])}else if(r)try{E(e,""),new Function(r)()}catch(t){console.error(name,t,"\\\\n"+r),o="error",s=String(t.stack||t)+""}E(-1,""),u.H([2,e,s])})(i):4===o?(({O:t,t:e,I:r,L:n,b:s},o)=>{if(o=c[r])try{const r=K(t,e,[],n),i=K(t,e,[],s);o.apply(r,i)}catch(t){console.error(t)}})(i):5===o?(t=>{const e=t.O,r={D:t.D,O:e,n:[]};for(const n of t.K){let t,s,o,i,a=n.t,c=n.a,$=n.C,h=l($),u=$[h-1];try{for(t=Q({...n,O:e}),i=0;i<h-1;i++)t=t[$[i]];o=K(e,a,$,n.h),0===c?s=t[u]:1===c?t[u]=o:2===c&&(s=4===a&&"createElement"===u?Y(t,$,o,n.r,n.E):t[u].apply(t,o)),r.J=G(e,a,s)}catch(t){r.n.push(String(t.stack||t))}}u.H([6,r])})(i):7===o?(({O:e,t:r,p:n,b:s})=>{let o=K(e,r,[],s),i=t,a=i[n[0]];try{Array.isArray(a)?a.push(...o):"function"==typeof a&&a.apply(i,o)}catch(t){console.error(t)}})(i):8===o&&b(i,a):1===o?(((t,e)=>{Object.assign(u,e),u.O,u.O>1&&u.G,u.s=importScripts.bind(t),t.importScripts=void 0,u.H=postMessage.bind(t),t.postMessage=(t,e)=>{JSON.stringify(t)},u.B=new C(e.M),((t,e)=>{t[r]=u.O,t[n]=0,Object.keys(e).forEach((r=>{t[r]||2!==e[r]||(t[r]=(...e)=>Y(t,[r],e))})),t.requestAnimationFrame=t=>p((()=>t(Date.now())),9),t.cancelAnimationFrame=clearTimeout,Object.defineProperty(t,"location",{get:()=>u.B,set:t=>u.B.href=t+""}),t.document=F(9,4),t.history=F(8,1),t.localStorage=F(10,2),t.sessionStorage=F(10,3),t.Image=tt,navigator.sendBeacon=x,t.self=t.window=t,1===u.O?t.parent=t.top=t:(t.parent=F(0,0,u.G),t.top=F(0,0,1))})(t,e.v[0][1]),u.y=!0})(t,i),u.H([3]),p((()=>{et.slice().forEach(rt),et.length=0}))):et.push(e)};t.onmessage=rt,postMessage([0])})(self);\\n\'],{type:"text/javascript"})),{name:`Partytown (${t.O}) 🎉`}),t.P.onmessage=e=>((t,e)=>{const r=e[0],n=t.N.document;if(0===r){const e=l(t,n.querySelector("script")),r=((t,e)=>{const r=e.implementation.createHTMLDocument(),n=r.documentElement;return[[0,t],[9,r],[6,n.classList],[1,n],[8,t.history],[7,n.childNodes],[10,t.sessionStorage],[3,r.createTextNode("")]].map((([t,e])=>[t,I(e,{})]))})(t.N,n),s={O:t.O,G:t.G,d:t.d||{},i:n.compatMode,j:n.cookie,k:n.readyState,l:n.referrer,m:n.title,o:e,v:r,A:new URL(t.A,t.M)+"",M:t.M};t.P.postMessage([1,s])}else if(3===r)w(t);else if(2===r)((t,e,r,n,s)=>{(s=e.querySelector(\'[data-pt-id="\'+t.O+"."+r+\'"]\'))&&(n?s.dataset.ptError=n:s.type+="-init"),w(t)})(t,n,e[1],e[2]);else if(6===r){const r=e[1],n=i.get(r.D);n&&(i.delete(r.D),n(r),w(t))}else 8===r&&$.forEach((t=>t.P.postMessage(e)))})(t,e.data)})(n),t.addEventListener("load",(()=>w(n)))}};n._ptWin=c,await(async(t,r)=>{const n=t.navigator.serviceWorker,s=await n.getRegistration(),a=t=>{s&&s.active&&s.active.postMessage(t)};return n.addEventListener("message",(t=>((t,r)=>{const n=t.O,s=$.get(n);(async(t,r)=>{const n={D:r.D,O:r.O,n:[]};for(const i of r.K){let a,c,u,$,d,l,g,y=i.t,w=i.a,I=i.C,S=e(I),E=I[S-1],k=i.r||o;try{if(u=m(i.h),r.q)continue;if(a=h(n.O,y),a){for($=0;$<S-1;$++)a=a[I[$]];0===w?("_ptId"===E&&await new Promise((t=>{d=0,l=setInterval((()=>{(b(a,I)||d>99)&&(clearInterval(l),t()),d++}),40)})),c=a[E]):1===w?a[E]=u:2===w&&(c=a[E].apply(a,u),k.map((t=>{g=t[0][0],c[g]=m(t[1])})),i.E&&p(t,c,i.E)),"object"==typeof(s=c)&&s&&s.then&&(c=await c,n.z=!0),n.J=f(t,c)}else n.n.push(`Instance ${y} not found`)}catch(t){n.n.push(String(t.stack||t))}}var s;return r.q?((t,e)=>new Promise((r=>{i.set(e.D,r),t.postMessage([5,e])})))(t.P,r):n})(s,t).then(r)})(t.data,a))),!!s})(t)&&c(n)})(t,1)})(window);\n<\/script></head></html>')):i.endsWith("proxytown")&&s.respondWith(((n,s)=>new Promise((async o=>{const i=await s.clone().json(),a=await((r,n)=>new Promise((async s=>{const o=[...await r.clients.matchAll()].sort(((t,e)=>t.url>e.url?-1:t.url<e.url?1:0))[0];if(o){const r=[s,setTimeout((()=>{t.delete(n.D),s(e(n,"Timeout"))}),1e4)];t.set(n.D,r),o.postMessage(n)}else s(e(n,"No Party"))})))(n,i);o(r(JSON.stringify(a),"application/json"))})))(n,o))})(n,s);
